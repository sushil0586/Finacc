# Generated by Django 4.2.28 on 2026-02-27 06:14

from decimal import Decimal
from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('entity', '0001_initial'),
        ('catalog', '0001_initial'),
        ('financial', '0001_initial'),
        ('geography', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Gstr2bImportBatch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('period', models.CharField(max_length=7)),
                ('source', models.CharField(default='gstr2b', max_length=50)),
                ('reference', models.CharField(blank=True, max_length=100, null=True)),
                ('entity', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='entity.entity')),
                ('entityfinid', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='entity.entityfinancialyear')),
                ('imported_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL)),
                ('subentity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.subentity')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('file', models.FileField(upload_to='purchase/attachments/%Y/%m/')),
                ('original_name', models.CharField(blank=True, max_length=255, null=True)),
                ('content_type', models.CharField(blank=True, max_length=100, null=True)),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseInvoiceHeader',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('doc_type', models.IntegerField(choices=[(1, 'Tax Invoice'), (2, 'Credit Note'), (3, 'Debit Note')], default=1)),
                ('bill_date', models.DateField(default=django.utils.timezone.now)),
                ('posting_date', models.DateField(blank=True, db_index=True, null=True)),
                ('credit_days', models.PositiveSmallIntegerField(blank=True, null=True)),
                ('due_date', models.DateField(blank=True, db_index=True, null=True)),
                ('doc_code', models.CharField(default='PINV', max_length=10)),
                ('doc_no', models.PositiveIntegerField(blank=True, null=True)),
                ('purchase_number', models.CharField(blank=True, max_length=50, null=True)),
                ('supplier_invoice_number', models.CharField(blank=True, max_length=50, null=True)),
                ('supplier_invoice_date', models.DateField(blank=True, null=True)),
                ('vendor_name', models.CharField(blank=True, max_length=200, null=True)),
                ('vendor_gstin', models.CharField(blank=True, max_length=15, null=True)),
                ('supply_category', models.IntegerField(choices=[(1, 'Domestic'), (2, 'Import of Goods'), (3, 'Import of Services'), (4, 'SEZ Purchase')], default=1)),
                ('default_taxability', models.IntegerField(choices=[(1, 'Taxable'), (2, 'Exempt'), (3, 'Nil-rated'), (4, 'Non-GST')], default=1)),
                ('tax_regime', models.IntegerField(choices=[(1, 'Intra-state (CGST+SGST)'), (2, 'Inter-state (IGST)')], default=1)),
                ('is_igst', models.BooleanField(default=False)),
                ('is_reverse_charge', models.BooleanField(default=False)),
                ('is_itc_eligible', models.BooleanField(default=True)),
                ('gstr2b_match_status', models.IntegerField(choices=[(0, 'Not Applicable'), (1, 'Not Checked'), (2, 'Matched'), (3, 'Mismatched'), (4, 'Not in 2B'), (5, 'Partial / Needs Review')], default=1)),
                ('itc_claim_status', models.IntegerField(choices=[(0, 'Not Applicable'), (1, 'Pending'), (2, 'Claimed'), (3, 'Reversed'), (4, 'Blocked (17(5)/etc)')], default=1)),
                ('itc_claim_period', models.CharField(blank=True, max_length=7, null=True)),
                ('itc_claimed_at', models.DateTimeField(blank=True, null=True)),
                ('itc_block_reason', models.CharField(blank=True, max_length=200, null=True)),
                ('is_rate_inclusive_of_tax_default', models.BooleanField(default=False)),
                ('total_taxable', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_cgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_sgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_igst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_cess', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_gst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('round_off', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('grand_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('status', models.IntegerField(choices=[(1, 'Draft'), (2, 'Confirmed'), (3, 'Posted'), (9, 'Cancelled')], default=1)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='created_purchase_documents', to=settings.AUTH_USER_MODEL)),
                ('entity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.entity')),
                ('entityfinid', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.entityfinancialyear')),
                ('place_of_supply_state', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_pos_state_docs', to='geography.state')),
                ('ref_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_notes', to='purchase.purchaseinvoiceheader')),
                ('subentity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.subentity')),
                ('supplier_state', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_supplier_state_docs', to='geography.state')),
                ('vendor', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_documents', to='financial.account')),
                ('vendor_state', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_vendor_state_docs', to='geography.state')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('default_doc_code_invoice', models.CharField(default='PINV', max_length=10)),
                ('default_doc_code_cn', models.CharField(default='PCN', max_length=10)),
                ('default_doc_code_dn', models.CharField(default='PDN', max_length=10)),
                ('default_workflow_action', models.CharField(choices=[('draft', 'Save as Draft'), ('confirm', 'Auto Confirm on Save'), ('post', 'Auto Post on Save')], db_index=True, default='draft', max_length=10)),
                ('auto_derive_tax_regime', models.BooleanField(default=True)),
                ('enforce_2b_before_itc_claim', models.BooleanField(default=False)),
                ('allow_mixed_taxability_in_one_bill', models.BooleanField(default=True)),
                ('round_grand_total_to', models.PositiveSmallIntegerField(default=2)),
                ('enable_round_off', models.BooleanField(default=True)),
                ('entity', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='purchase_purchase_settings', to='entity.entity')),
                ('subentity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_purchase_settings_fy', to='entity.subentity')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseLockPeriod',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('lock_date', models.DateField()),
                ('reason', models.CharField(blank=True, max_length=200, null=True)),
                ('entity', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='entity.entity')),
                ('subentity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.subentity')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseItcAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('action_type', models.CharField(choices=[('CLAIM', 'Claim ITC'), ('REVERSE', 'Reverse ITC'), ('BLOCK', 'Block ITC'), ('UNBLOCK', 'Unblock (back to pending)'), ('SET_PENDING', 'Set Pending'), ('ADJUST', 'Adjustment')], max_length=20)),
                ('period', models.CharField(blank=True, max_length=7, null=True)),
                ('from_status', models.IntegerField(blank=True, null=True)),
                ('to_status', models.IntegerField(blank=True, null=True)),
                ('igst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('sgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cess', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('reason', models.CharField(blank=True, max_length=300, null=True)),
                ('notes', models.CharField(blank=True, max_length=1000, null=True)),
                ('acted_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('acted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='purchase_itc_actions', to=settings.AUTH_USER_MODEL)),
                ('attachment', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='purchase.purchaseattachment')),
                ('gstr2b_batch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='purchase.gstr2bimportbatch')),
                ('header', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='itc_actions', to='purchase.purchaseinvoiceheader')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseInvoiceLine',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('line_no', models.PositiveIntegerField()),
                ('product_desc', models.CharField(blank=True, max_length=500, null=True)),
                ('is_service', models.BooleanField(default=False)),
                ('hsn_sac', models.CharField(blank=True, max_length=10, null=True)),
                ('qty', models.DecimalField(decimal_places=4, default=Decimal('0.0000'), max_digits=14)),
                ('free_qty', models.DecimalField(decimal_places=4, default=Decimal('0.0000'), max_digits=14)),
                ('rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('is_rate_inclusive_of_tax', models.BooleanField(default=False)),
                ('discount_type', models.CharField(choices=[('N', 'None'), ('P', 'Percent'), ('A', 'Amount')], default='N', max_length=1)),
                ('discount_percent', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('discount_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('taxability', models.IntegerField(choices=[(1, 'Taxable'), (2, 'Exempt'), (3, 'Nil-rated'), (4, 'Non-GST')], default=1)),
                ('taxable_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('gst_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('cgst_percent', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('sgst_percent', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('igst_percent', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('cgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('sgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('igst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cess_percent', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('cess_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('line_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('is_itc_eligible', models.BooleanField(default=True)),
                ('itc_block_reason', models.CharField(blank=True, max_length=200, null=True)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('header', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lines', to='purchase.purchaseinvoiceheader')),
                ('product', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='catalog.product')),
                ('uom', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='catalog.unitofmeasure')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseChoiceOverride',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('choice_group', models.CharField(max_length=50)),
                ('choice_key', models.CharField(max_length=50)),
                ('is_enabled', models.BooleanField(default=True)),
                ('override_label', models.CharField(blank=True, max_length=200, null=True)),
                ('entity', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='entity.entity')),
                ('subentity', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='entity.subentity')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseChargeLine',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('line_no', models.PositiveIntegerField()),
                ('description', models.CharField(max_length=200)),
                ('taxable_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('gst_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('cgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('sgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('igst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('header', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='charges', to='purchase.purchaseinvoiceheader')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseattachment',
            name='header',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attachments', to='purchase.purchaseinvoiceheader'),
        ),
        migrations.AddField(
            model_name='purchaseattachment',
            name='uploaded_by',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to=settings.AUTH_USER_MODEL),
        ),
        migrations.CreateModel(
            name='Gstr2bImportRow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now, editable=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('supplier_gstin', models.CharField(blank=True, max_length=15, null=True)),
                ('supplier_name', models.CharField(blank=True, max_length=200, null=True)),
                ('supplier_invoice_number', models.CharField(blank=True, max_length=50, null=True)),
                ('supplier_invoice_date', models.DateField(blank=True, null=True)),
                ('doc_type', models.CharField(blank=True, max_length=20, null=True)),
                ('is_igst', models.BooleanField(default=False)),
                ('taxable_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('igst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('sgst', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cess', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('match_status', models.CharField(default='NOT_CHECKED', max_length=20)),
                ('batch', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='rows', to='purchase.gstr2bimportbatch')),
                ('matched_purchase', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='gstr2b_matches', to='purchase.purchaseinvoiceheader')),
                ('pos_state', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, to='geography.state')),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseTaxSummary',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('taxability', models.IntegerField(choices=[(1, 'Taxable'), (2, 'Exempt'), (3, 'Nil-rated'), (4, 'Non-GST')], default=1)),
                ('hsn_sac', models.CharField(blank=True, max_length=10, null=True)),
                ('is_service', models.BooleanField(default=False)),
                ('gst_rate', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=5)),
                ('is_reverse_charge', models.BooleanField(default=False)),
                ('taxable_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('sgst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('igst_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('cess_amount', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('total_value', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('itc_eligible_tax', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('itc_ineligible_tax', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=14)),
                ('header', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tax_summaries', to='purchase.purchaseinvoiceheader')),
            ],
            options={
                'indexes': [models.Index(fields=['header'], name='ix_pur_taxsum_header')],
            },
        ),
        migrations.AddConstraint(
            model_name='purchasetaxsummary',
            constraint=models.UniqueConstraint(fields=('header', 'taxability', 'hsn_sac', 'is_service', 'gst_rate', 'is_reverse_charge'), name='uq_pur_taxsum_bucket'),
        ),
        migrations.AddIndex(
            model_name='purchasesettings',
            index=models.Index(fields=['entity'], name='ix_purchase_settings_entity'),
        ),
        migrations.AddConstraint(
            model_name='purchasesettings',
            constraint=models.UniqueConstraint(fields=('entity', 'subentity'), name='uq_purchase_settings_entity_subentity'),
        ),
        migrations.AddIndex(
            model_name='purchaselockperiod',
            index=models.Index(fields=['entity', 'subentity', 'lock_date'], name='ix_purchase_lock_period'),
        ),
        migrations.AddIndex(
            model_name='purchaseitcaction',
            index=models.Index(fields=['header', 'acted_at'], name='ix_pur_itc_action_header_date'),
        ),
        migrations.AddIndex(
            model_name='purchaseitcaction',
            index=models.Index(fields=['period'], name='ix_pur_itc_action_period'),
        ),
        migrations.AddIndex(
            model_name='purchaseitcaction',
            index=models.Index(fields=['action_type'], name='ix_pur_itc_action_type'),
        ),
        migrations.AddConstraint(
            model_name='purchaseitcaction',
            constraint=models.CheckConstraint(check=models.Q(('igst__gte', 0), ('cgst__gte', 0), ('sgst__gte', 0), ('cess__gte', 0)), name='ck_pur_itc_action_nonneg'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceline',
            index=models.Index(fields=['header', 'product'], name='ix_pur_line_header_product'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceline',
            index=models.Index(fields=['header', 'hsn_sac'], name='ix_pur_line_header_hsn'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.UniqueConstraint(fields=('header', 'line_no'), name='uq_purchase_line_header_lineno'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('qty__gte', 0)), name='ck_pur_qty_nonneg'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('free_qty__gte', 0)), name='ck_pur_freeqty_nonneg'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('rate__gte', 0)), name='ck_pur_rate_nonneg'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('discount_percent__gte', 0), ('discount_percent__lte', 100)), name='ck_pur_disc_pct_range'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('discount_amount__gte', 0)), name='ck_pur_disc_amt_nonneg'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('gst_rate__gte', 0), ('gst_rate__lte', 100)), name='ck_pur_gst_rate_range'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceline',
            constraint=models.CheckConstraint(check=models.Q(('cess_percent__gte', 0), ('cess_percent__lte', 100)), name='ck_pur_cess_rate_range'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceheader',
            index=models.Index(fields=['entity', 'entityfinid', 'bill_date'], name='ix_pur_ent_fin_dt'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceheader',
            index=models.Index(fields=['entity', 'entityfinid', 'vendor'], name='ix_pur_ent_fin_vendor'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceheader',
            index=models.Index(fields=['entity', 'entityfinid', 'doc_code', 'doc_no'], name='ix_pur_docno_lookup'),
        ),
        migrations.AddIndex(
            model_name='purchaseinvoiceheader',
            index=models.Index(fields=['entity', 'entityfinid', 'vendor', 'due_date'], name='ix_pur_ap_due'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceheader',
            constraint=models.UniqueConstraint(fields=('entity', 'entityfinid', 'doc_type', 'doc_code', 'doc_no'), name='uq_purchase_doc_entity_fin_type_code_no'),
        ),
        migrations.AddConstraint(
            model_name='purchaseinvoiceheader',
            constraint=models.CheckConstraint(check=models.Q(models.Q(('doc_type', 1), ('ref_document__isnull', True)), models.Q(('doc_type__in', [2, 3]), ('ref_document__isnull', False)), _connector='OR'), name='ck_purchase_ref_required_for_notes'),
        ),
        migrations.AddIndex(
            model_name='purchasechoiceoverride',
            index=models.Index(fields=['entity', 'subentity', 'choice_group'], name='ix_pur_choice_override_scope'),
        ),
        migrations.AddConstraint(
            model_name='purchasechoiceoverride',
            constraint=models.UniqueConstraint(fields=('entity', 'subentity', 'choice_group', 'choice_key'), name='uq_purchase_choice_override_scope'),
        ),
        migrations.AddConstraint(
            model_name='purchasechoiceoverride',
            constraint=models.CheckConstraint(check=models.Q(('choice_group__isnull', False), ('choice_key__isnull', False)), name='ck_purchase_choice_override_group_key_nn'),
        ),
        migrations.AddIndex(
            model_name='purchasechargeline',
            index=models.Index(fields=['header'], name='ix_purchase_charge_header'),
        ),
        migrations.AddConstraint(
            model_name='purchasechargeline',
            constraint=models.UniqueConstraint(fields=('header', 'line_no'), name='uq_purchase_charge_header_lineno'),
        ),
        migrations.AddConstraint(
            model_name='purchasechargeline',
            constraint=models.CheckConstraint(check=models.Q(('taxable_value__gte', 0), ('gst_rate__gte', 0), ('gst_rate__lte', 100), ('cgst_amount__gte', 0), ('sgst_amount__gte', 0), ('igst_amount__gte', 0), ('total_value__gte', 0)), name='ck_purchase_charge_nonneg'),
        ),
        migrations.AddIndex(
            model_name='purchaseattachment',
            index=models.Index(fields=['header'], name='ix_purchase_attachment_header'),
        ),
        migrations.AddIndex(
            model_name='gstr2bimportrow',
            index=models.Index(fields=['batch'], name='ix_gstr2b_row_batch'),
        ),
        migrations.AddIndex(
            model_name='gstr2bimportrow',
            index=models.Index(fields=['supplier_gstin', 'supplier_invoice_number'], name='ix_gstr2b_row_gstin_invno'),
        ),
        migrations.AddIndex(
            model_name='gstr2bimportrow',
            index=models.Index(fields=['matched_purchase'], name='ix_gstr2b_row_matched_purchase'),
        ),
        migrations.AddConstraint(
            model_name='gstr2bimportrow',
            constraint=models.CheckConstraint(check=models.Q(('taxable_value__gte', 0), ('igst__gte', 0), ('cgst__gte', 0), ('sgst__gte', 0), ('cess__gte', 0)), name='ck_gstr2b_row_nonneg'),
        ),
        migrations.AddIndex(
            model_name='gstr2bimportbatch',
            index=models.Index(fields=['entity', 'entityfinid', 'subentity', 'period'], name='ix_gstr2b_batch_scope_period'),
        ),
        migrations.AddConstraint(
            model_name='gstr2bimportbatch',
            constraint=models.UniqueConstraint(fields=('entity', 'entityfinid', 'subentity', 'period', 'reference'), name='uq_gstr2b_batch_scope_period_ref'),
        ),
    ]
